{
    "sourceFile": "frontend/components/profileMenu/NotificationContent.tsx",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 7,
            "patches": [
                {
                    "date": 1738769837254,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1738769845975,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -108,9 +108,9 @@\n               </div>\r\n             </Badge>\r\n           </div>\r\n         </DropdownMenuTrigger>\r\n-        <DropdownMenuContent className=\"w-76 sm:w-96 bg-[var(--sidebar-background)] p-0 border-0\">\r\n+        <DropdownMenuContent className=\"w-86 sm:w-96 bg-[var(--sidebar-background)] p-0 border-0\">\r\n           <DropdownMenuLabel className=\"bg-slate-100 p-4 dark:bg-[var(--sidebar-background)]\">\r\n             Notifications\r\n           </DropdownMenuLabel>\r\n           <DropdownMenuLabel className=\"bg-slate-200 dark:bg-[var(--sidebar-accent)] px-4 font-medium text-slate-500\">\r\n"
                },
                {
                    "date": 1738769859525,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -108,9 +108,9 @@\n               </div>\r\n             </Badge>\r\n           </div>\r\n         </DropdownMenuTrigger>\r\n-        <DropdownMenuContent className=\"w-86 sm:w-96 bg-[var(--sidebar-background)] p-0 border-0\">\r\n+        <DropdownMenuContent className=\"w-80 sm:w-96 bg-[var(--sidebar-background)] p-0 border-0\">\r\n           <DropdownMenuLabel className=\"bg-slate-100 p-4 dark:bg-[var(--sidebar-background)]\">\r\n             Notifications\r\n           </DropdownMenuLabel>\r\n           <DropdownMenuLabel className=\"bg-slate-200 dark:bg-[var(--sidebar-accent)] px-4 font-medium text-slate-500\">\r\n"
                },
                {
                    "date": 1738769871108,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -108,9 +108,9 @@\n               </div>\r\n             </Badge>\r\n           </div>\r\n         </DropdownMenuTrigger>\r\n-        <DropdownMenuContent className=\"w-80 sm:w-96 bg-[var(--sidebar-background)] p-0 border-0\">\r\n+        <DropdownMenuContent className=\"w-90 sm:w-96 bg-[var(--sidebar-background)] p-0 border-0\">\r\n           <DropdownMenuLabel className=\"bg-slate-100 p-4 dark:bg-[var(--sidebar-background)]\">\r\n             Notifications\r\n           </DropdownMenuLabel>\r\n           <DropdownMenuLabel className=\"bg-slate-200 dark:bg-[var(--sidebar-accent)] px-4 font-medium text-slate-500\">\r\n"
                },
                {
                    "date": 1738769882238,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -108,9 +108,9 @@\n               </div>\r\n             </Badge>\r\n           </div>\r\n         </DropdownMenuTrigger>\r\n-        <DropdownMenuContent className=\"w-90 sm:w-96 bg-[var(--sidebar-background)] p-0 border-0\">\r\n+        <DropdownMenuContent className=\"w-96 sm:w-96 bg-[var(--sidebar-background)] p-0 border-0\">\r\n           <DropdownMenuLabel className=\"bg-slate-100 p-4 dark:bg-[var(--sidebar-background)]\">\r\n             Notifications\r\n           </DropdownMenuLabel>\r\n           <DropdownMenuLabel className=\"bg-slate-200 dark:bg-[var(--sidebar-accent)] px-4 font-medium text-slate-500\">\r\n"
                },
                {
                    "date": 1738769893978,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -108,9 +108,9 @@\n               </div>\r\n             </Badge>\r\n           </div>\r\n         </DropdownMenuTrigger>\r\n-        <DropdownMenuContent className=\"w-96 sm:w-96 bg-[var(--sidebar-background)] p-0 border-0\">\r\n+        <DropdownMenuContent className=\"w-96 bg-[var(--sidebar-background)] p-0 border-0\">\r\n           <DropdownMenuLabel className=\"bg-slate-100 p-4 dark:bg-[var(--sidebar-background)]\">\r\n             Notifications\r\n           </DropdownMenuLabel>\r\n           <DropdownMenuLabel className=\"bg-slate-200 dark:bg-[var(--sidebar-accent)] px-4 font-medium text-slate-500\">\r\n"
                },
                {
                    "date": 1738769942661,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -92,9 +92,9 @@\n   }, []);\r\n \r\n   return (\r\n     <div className=\"custom\">\r\n-      <DropdownMenu pa>\r\n+      <DropdownMenu >\r\n         <DropdownMenuTrigger asChild>\r\n           <div className=\"flex cursor-pointer mr-6\">\r\n             <Badge\r\n               count={NotSeen.length}\r\n"
                },
                {
                    "date": 1739302355980,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -23,9 +23,9 @@\n     (notification) => notification.seen === false\r\n   );\r\n   const { data: session } = useSession();\r\n \r\n-  const {data} = usegetuser\r\n+  const {data} = useGetUserNotifications()\r\n   useEffect(() => {\r\n     const fetchData = async () => {\r\n       try {\r\n         const response = await fetch(\r\n"
                }
            ],
            "date": 1738769837254,
            "name": "Commit-0",
            "content": "\"use client\";\r\nimport {\r\n  DropdownMenu,\r\n  DropdownMenuContent,\r\n  DropdownMenuItem,\r\n  DropdownMenuLabel,\r\n  DropdownMenuTrigger,\r\n} from \"@/components/ui/dropdown-menu\";\r\nimport { ArrowRightOutlined, BellOutlined } from \"@ant-design/icons\";\r\nimport { Badge } from \"antd\";\r\nimport SingleNotification from \"./SingleNotification\";\r\nimport Link from \"next/link\";\r\nimport { useEffect, useState } from \"react\";\r\nimport { useSession } from \"next-auth/react\";\r\nimport { SocketInitiator } from \"../togglers/TopBarEvents\";\r\nimport { Notification, ObjectType } from \"@/types\";\r\nimport { DashboardHook } from \"../context/Dashboardprovider\";\r\n\r\nexport const NotificationContent = () => {\r\n  const [notifications, setNotifications] = useState<Notification[]>([]);\r\n  const { socket } = DashboardHook();\r\n  const NotSeen = notifications.filter(\r\n    (notification) => notification.seen === false\r\n  );\r\n  const { data: session } = useSession();\r\n\r\n  useEffect(() => {\r\n    const fetchData = async () => {\r\n      try {\r\n        const response = await fetch(\r\n          `http://localhost:8080/api/notifications/${session?.user.id}`\r\n        );\r\n        const data = await response.json();\r\n        setNotifications(data.notifications);\r\n      } catch (error) {\r\n        console.error(error);\r\n      }\r\n    };\r\n    fetchData();\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    const role = session?.user.role;\r\n    const initiator = async (\r\n      NotificationTo: string,\r\n      tone: keyof ObjectType\r\n    ) => {\r\n      try {\r\n        await SocketInitiator(NotificationTo, tone, socket, setNotifications);\r\n      } catch (error) {\r\n        console.log(error);\r\n      }\r\n    };\r\n    if (!role || !socket) return;\r\n\r\n    if (role === \"Admin\") {\r\n      initiator(\"adminNotification\", \"adminOnly\");\r\n\r\n      initiator(`Admin_${session.user.id}`, \"public\");\r\n\r\n      if (!session.user.verified) {\r\n        initiator(`EmailVerification${session.user.id}`, \"public\");\r\n      }\r\n    } else {\r\n      if (!session.user.verified) {\r\n        initiator(`EmailVerification${session.user.id}`, \"public\");\r\n      }\r\n    }\r\n\r\n    // Cleanup listeners\r\n    return () => {\r\n      if (role === \"Admin\") {\r\n        socket.off(\"adminNotification\");\r\n        socket.off(`Admin_${session.user.id}`);\r\n        if (!session.user.verified) {\r\n          socket.off(`EmailVerification${session.user.id}`);\r\n        }\r\n      } else {\r\n        if (!session.user.verified) {\r\n          socket.off(`EmailVerification${session.user.id}`);\r\n        }\r\n      }\r\n    };\r\n  }, [session?.user?.role, socket]);\r\n\r\n  useEffect(() => {\r\n    const interval = setInterval(() => {\r\n      setNotifications((prev: Notification[]) => [...prev]);\r\n    }, 1000);\r\n\r\n    return () => clearInterval(interval);\r\n  }, []);\r\n\r\n  return (\r\n    <div className=\"custom\">\r\n      <DropdownMenu>\r\n        <DropdownMenuTrigger asChild>\r\n          <div className=\"flex cursor-pointer mr-6\">\r\n            <Badge\r\n              count={NotSeen.length}\r\n              size=\"small\"\r\n              offset={[0, 0]}\r\n              color=\"blue\"\r\n              style={{ boxShadow: \"none\" }}\r\n            >\r\n              <div className=\"flex\">\r\n                <BellOutlined className=\"text-xl dark:text-slate-50\" />\r\n              </div>\r\n            </Badge>\r\n          </div>\r\n        </DropdownMenuTrigger>\r\n        <DropdownMenuContent className=\"w-76 sm:w-96 bg-[var(--sidebar-background)] p-0 border-0\">\r\n          <DropdownMenuLabel className=\"bg-slate-100 p-4 dark:bg-[var(--sidebar-background)]\">\r\n            Notifications\r\n          </DropdownMenuLabel>\r\n          <DropdownMenuLabel className=\"bg-slate-200 dark:bg-[var(--sidebar-accent)] px-4 font-medium text-slate-500\">\r\n            Today\r\n          </DropdownMenuLabel>\r\n          <SingleNotification notifications={notifications} />\r\n          <Link href={\"/dashboard/notifications\"} className=\"flex\">\r\n            <DropdownMenuItem className=\"p-0 w-full cursor-pointer \">\r\n              <div className=\"flex items-center justify-center w-full px-4 py-2 text-slate-500 dark:text-slate-300 hover:bg-slate-200 dark:hover:bg-[var(--sidebar-accent)]\">\r\n                View All Notifications\r\n                <ArrowRightOutlined className=\"ml-2\" />\r\n              </div>\r\n            </DropdownMenuItem>\r\n          </Link>\r\n        </DropdownMenuContent>\r\n      </DropdownMenu>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default NotificationContent;\r\n"
        }
    ]
}