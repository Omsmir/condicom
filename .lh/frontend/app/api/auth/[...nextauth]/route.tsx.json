{
    "sourceFile": "frontend/app/api/auth/[...nextauth]/route.tsx",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 22,
            "patches": [
                {
                    "date": 1739030240877,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1739280634658,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -16,8 +16,9 @@\n         password: { label: \"Password\", type: \"password\" },\r\n       },\r\n       authorize: async (credentials) => {\r\n         try {\r\n+          const \r\n           const response = await axios.post(\r\n             \"http://localhost:8080/api/auth/login\",\r\n             {\r\n               email: credentials?.email,\r\n@@ -90,9 +91,8 @@\n           verified: token.verified,\r\n           code:token.code\r\n         };\r\n       }\r\n-      console.log(session);\r\n       return session;\r\n     },\r\n   },\r\n   secret: process.env.NEXTAUTH_SECRET,\r\n"
                },
                {
                    "date": 1739280641210,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -16,9 +16,9 @@\n         password: { label: \"Password\", type: \"password\" },\r\n       },\r\n       authorize: async (credentials) => {\r\n         try {\r\n-          const \r\n+          const login\r\n           const response = await axios.post(\r\n             \"http://localhost:8080/api/auth/login\",\r\n             {\r\n               email: credentials?.email,\r\n"
                },
                {
                    "date": 1739280647242,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -4,8 +4,9 @@\n import jwt, { JwtPayload } from \"jsonwebtoken\";\r\n import { JWT } from \"next-auth/jwt\";\r\n import { cookies } from \"next/headers\";\r\n import { UserInformation } from \"@/types\";\r\n+import { useLogin } from \"@/actions/mutation\";\r\n \r\n const authOptions: AuthOptions = {\r\n \r\n   providers: [\r\n@@ -16,9 +17,9 @@\n         password: { label: \"Password\", type: \"password\" },\r\n       },\r\n       authorize: async (credentials) => {\r\n         try {\r\n-          const login\r\n+          const login = useLogin()\r\n           const response = await axios.post(\r\n             \"http://localhost:8080/api/auth/login\",\r\n             {\r\n               email: credentials?.email,\r\n"
                },
                {
                    "date": 1739280794808,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -4,9 +4,8 @@\n import jwt, { JwtPayload } from \"jsonwebtoken\";\r\n import { JWT } from \"next-auth/jwt\";\r\n import { cookies } from \"next/headers\";\r\n import { UserInformation } from \"@/types\";\r\n-import { useLogin } from \"@/actions/mutation\";\r\n \r\n const authOptions: AuthOptions = {\r\n \r\n   providers: [\r\n"
                },
                {
                    "date": 1739287250493,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -2,10 +2,8 @@\n import CredentialsProvider from \"next-auth/providers/credentials\";\r\n import axios from \"axios\";\r\n import jwt, { JwtPayload } from \"jsonwebtoken\";\r\n import { JWT } from \"next-auth/jwt\";\r\n-import { cookies } from \"next/headers\";\r\n-import { UserInformation } from \"@/types\";\r\n \r\n const authOptions: AuthOptions = {\r\n \r\n   providers: [\r\n@@ -16,9 +14,8 @@\n         password: { label: \"Password\", type: \"password\" },\r\n       },\r\n       authorize: async (credentials) => {\r\n         try {\r\n-          const login = useLogin()\r\n           const response = await axios.post(\r\n             \"http://localhost:8080/api/auth/login\",\r\n             {\r\n               email: credentials?.email,\r\n@@ -49,15 +46,15 @@\n           return null; // Return null if no token is found\r\n         } catch (error: any) {\r\n           console.error(\"Login Error:\", error.response?.data || error.message);\r\n \r\n-          if (error.response) {\r\n-            const { status, data } = error.response;\r\n-            if (status === 401) throw new Error(\"Invalid email or password.\");\r\n-            if (status === 403)\r\n-              throw new Error(data?.msg || \"Access forbidden.\");\r\n-            throw new Error(data?.msg || \"An unexpected error occurred.\");\r\n-          }\r\n+          // if (error.response) {\r\n+          //   const { status, data } = error.response;\r\n+          //   if (status === 401) throw new Error(\"Invalid email or password.\");\r\n+          //   if (status === 403)\r\n+          //     throw new Error(data?.msg || \"Access forbidden.\");\r\n+          //   throw new Error(data?.msg || \"An unexpected error occurred.\");\r\n+          // }\r\n \r\n           throw new Error(\"Unable to connect to the server.\");\r\n         }\r\n       },\r\n"
                },
                {
                    "date": 1739287356361,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -46,8 +46,9 @@\n           return null; // Return null if no token is found\r\n         } catch (error: any) {\r\n           console.error(\"Login Error:\", error.response?.data || error.message);\r\n \r\n+          handle\r\n           // if (error.response) {\r\n           //   const { status, data } = error.response;\r\n           //   if (status === 401) throw new Error(\"Invalid email or password.\");\r\n           //   if (status === 403)\r\n"
                },
                {
                    "date": 1739287364038,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -2,8 +2,9 @@\n import CredentialsProvider from \"next-auth/providers/credentials\";\r\n import axios from \"axios\";\r\n import jwt, { JwtPayload } from \"jsonwebtoken\";\r\n import { JWT } from \"next-auth/jwt\";\r\n+import HandleAxiosErrors from \"@/components/HandleAxiosErrors\";\r\n \r\n const authOptions: AuthOptions = {\r\n \r\n   providers: [\r\n@@ -46,9 +47,9 @@\n           return null; // Return null if no token is found\r\n         } catch (error: any) {\r\n           console.error(\"Login Error:\", error.response?.data || error.message);\r\n \r\n-          handle\r\n+          HandleAxiosErrors({api,error})\r\n           // if (error.response) {\r\n           //   const { status, data } = error.response;\r\n           //   if (status === 401) throw new Error(\"Invalid email or password.\");\r\n           //   if (status === 403)\r\n"
                },
                {
                    "date": 1739287389104,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -3,9 +3,9 @@\n import axios from \"axios\";\r\n import jwt, { JwtPayload } from \"jsonwebtoken\";\r\n import { JWT } from \"next-auth/jwt\";\r\n import HandleAxiosErrors from \"@/components/HandleAxiosErrors\";\r\n-\r\n+const \r\n const authOptions: AuthOptions = {\r\n \r\n   providers: [\r\n     CredentialsProvider({\r\n"
                },
                {
                    "date": 1739287394490,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -3,9 +3,9 @@\n import axios from \"axios\";\r\n import jwt, { JwtPayload } from \"jsonwebtoken\";\r\n import { JWT } from \"next-auth/jwt\";\r\n import HandleAxiosErrors from \"@/components/HandleAxiosErrors\";\r\n-const \r\n+\r\n const authOptions: AuthOptions = {\r\n \r\n   providers: [\r\n     CredentialsProvider({\r\n@@ -47,8 +47,9 @@\n           return null; // Return null if no token is found\r\n         } catch (error: any) {\r\n           console.error(\"Login Error:\", error.response?.data || error.message);\r\n \r\n+          const \r\n           HandleAxiosErrors({api,error})\r\n           // if (error.response) {\r\n           //   const { status, data } = error.response;\r\n           //   if (status === 401) throw new Error(\"Invalid email or password.\");\r\n"
                },
                {
                    "date": 1739287401561,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -47,9 +47,9 @@\n           return null; // Return null if no token is found\r\n         } catch (error: any) {\r\n           console.error(\"Login Error:\", error.response?.data || error.message);\r\n \r\n-          const \r\n+          const {api} = dashb\r\n           HandleAxiosErrors({api,error})\r\n           // if (error.response) {\r\n           //   const { status, data } = error.response;\r\n           //   if (status === 401) throw new Error(\"Invalid email or password.\");\r\n"
                },
                {
                    "date": 1739287423143,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -3,8 +3,9 @@\n import axios from \"axios\";\r\n import jwt, { JwtPayload } from \"jsonwebtoken\";\r\n import { JWT } from \"next-auth/jwt\";\r\n import HandleAxiosErrors from \"@/components/HandleAxiosErrors\";\r\n+import { DashboardHook } from \"@/components/context/Dashboardprovider\";\r\n \r\n const authOptions: AuthOptions = {\r\n \r\n   providers: [\r\n@@ -47,9 +48,8 @@\n           return null; // Return null if no token is found\r\n         } catch (error: any) {\r\n           console.error(\"Login Error:\", error.response?.data || error.message);\r\n \r\n-          const {api} = dashb\r\n           HandleAxiosErrors({api,error})\r\n           // if (error.response) {\r\n           //   const { status, data } = error.response;\r\n           //   if (status === 401) throw new Error(\"Invalid email or password.\");\r\n"
                },
                {
                    "date": 1739287433212,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -3,9 +3,8 @@\n import axios from \"axios\";\r\n import jwt, { JwtPayload } from \"jsonwebtoken\";\r\n import { JWT } from \"next-auth/jwt\";\r\n import HandleAxiosErrors from \"@/components/HandleAxiosErrors\";\r\n-import { DashboardHook } from \"@/components/context/Dashboardprovider\";\r\n \r\n const authOptions: AuthOptions = {\r\n \r\n   providers: [\r\n@@ -48,9 +47,9 @@\n           return null; // Return null if no token is found\r\n         } catch (error: any) {\r\n           console.error(\"Login Error:\", error.response?.data || error.message);\r\n \r\n-          HandleAxiosErrors({api,error})\r\n+         \r\n           // if (error.response) {\r\n           //   const { status, data } = error.response;\r\n           //   if (status === 401) throw new Error(\"Invalid email or password.\");\r\n           //   if (status === 403)\r\n"
                },
                {
                    "date": 1739287455526,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -3,8 +3,9 @@\n import axios from \"axios\";\r\n import jwt, { JwtPayload } from \"jsonwebtoken\";\r\n import { JWT } from \"next-auth/jwt\";\r\n import HandleAxiosErrors from \"@/components/HandleAxiosErrors\";\r\n+import { DashboardHook } from \"@/components/context/Dashboardprovider\";\r\n \r\n const authOptions: AuthOptions = {\r\n \r\n   providers: [\r\n@@ -47,9 +48,9 @@\n           return null; // Return null if no token is found\r\n         } catch (error: any) {\r\n           console.error(\"Login Error:\", error.response?.data || error.message);\r\n \r\n-         \r\n+          HandleAxiosErrors({api,error})\r\n           // if (error.response) {\r\n           //   const { status, data } = error.response;\r\n           //   if (status === 401) throw new Error(\"Invalid email or password.\");\r\n           //   if (status === 403)\r\n"
                },
                {
                    "date": 1739287462485,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -2,10 +2,8 @@\n import CredentialsProvider from \"next-auth/providers/credentials\";\r\n import axios from \"axios\";\r\n import jwt, { JwtPayload } from \"jsonwebtoken\";\r\n import { JWT } from \"next-auth/jwt\";\r\n-import HandleAxiosErrors from \"@/components/HandleAxiosErrors\";\r\n-import { DashboardHook } from \"@/components/context/Dashboardprovider\";\r\n \r\n const authOptions: AuthOptions = {\r\n \r\n   providers: [\r\n@@ -48,16 +46,15 @@\n           return null; // Return null if no token is found\r\n         } catch (error: any) {\r\n           console.error(\"Login Error:\", error.response?.data || error.message);\r\n \r\n-          HandleAxiosErrors({api,error})\r\n-          // if (error.response) {\r\n-          //   const { status, data } = error.response;\r\n-          //   if (status === 401) throw new Error(\"Invalid email or password.\");\r\n-          //   if (status === 403)\r\n-          //     throw new Error(data?.msg || \"Access forbidden.\");\r\n-          //   throw new Error(data?.msg || \"An unexpected error occurred.\");\r\n-          // }\r\n+          if (error.response) {\r\n+            const { status, data } = error.response;\r\n+            if (status === 401) throw new Error(\"Invalid email or password.\");\r\n+            if (status === 403)\r\n+              throw new Error(data?.msg || \"Access forbidden.\");\r\n+            throw new Error(data?.msg || \"An unexpected error occurred.\");\r\n+          }\r\n \r\n           throw new Error(\"Unable to connect to the server.\");\r\n         }\r\n       },\r\n"
                },
                {
                    "date": 1739287475553,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -48,9 +48,9 @@\n           console.error(\"Login Error:\", error.response?.data || error.message);\r\n \r\n           if (error.response) {\r\n             const { status, data } = error.response;\r\n-            if (status === 401) throw new Error(\"Invalid email or password.\");\r\n+            if (status. === 401) throw new Error(\"Invalid email or password.\");\r\n             if (status === 403)\r\n               throw new Error(data?.msg || \"Access forbidden.\");\r\n             throw new Error(data?.msg || \"An unexpected error occurred.\");\r\n           }\r\n"
                },
                {
                    "date": 1739287485748,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -48,11 +48,11 @@\n           console.error(\"Login Error:\", error.response?.data || error.message);\r\n \r\n           if (error.response) {\r\n             const { status, data } = error.response;\r\n-            if (status. === 401) throw new Error(\"Invalid email or password.\");\r\n+            if (status === 401) throw new Error(\"Invalid email or password.\");\r\n             if (status === 403)\r\n-              throw new Error(data?.msg || \"Access forbidden.\");\r\n+              throw new Error(data?.message || \"Access forbidden.\");\r\n             throw new Error(data?.msg || \"An unexpected error occurred.\");\r\n           }\r\n \r\n           throw new Error(\"Unable to connect to the server.\");\r\n"
                },
                {
                    "date": 1739287509640,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -48,12 +48,12 @@\n           console.error(\"Login Error:\", error.response?.data || error.message);\r\n \r\n           if (error.response) {\r\n             const { status, data } = error.response;\r\n-            if (status === 401) throw new Error(\"Invalid email or password.\");\r\n+            if (status === 401) throw new Error(dar);\r\n             if (status === 403)\r\n               throw new Error(data?.message || \"Access forbidden.\");\r\n-            throw new Error(data?.msg || \"An unexpected error occurred.\");\r\n+            throw new Error(data?.message || \"An unexpected error occurred.\");\r\n           }\r\n \r\n           throw new Error(\"Unable to connect to the server.\");\r\n         }\r\n"
                },
                {
                    "date": 1739287532935,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -48,9 +48,9 @@\n           console.error(\"Login Error:\", error.response?.data || error.message);\r\n \r\n           if (error.response) {\r\n             const { status, data } = error.response;\r\n-            if (status === 401) throw new Error(dar);\r\n+            if (status !== 200) throw new Error(data.message);\r\n             if (status === 403)\r\n               throw new Error(data?.message || \"Access forbidden.\");\r\n             throw new Error(data?.message || \"An unexpected error occurred.\");\r\n           }\r\n"
                },
                {
                    "date": 1739465607152,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -98,4 +98,7 @@\n const handler = NextAuth(authOptions);\r\n \r\n // Correctly export as HTTP methods\r\n export { handler as GET, handler as POST };\r\n+export const config = {\r\n+  runtime: \"nodejs\",\r\n+};\r\n"
                },
                {
                    "date": 1739465957873,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -98,7 +98,5 @@\n const handler = NextAuth(authOptions);\r\n \r\n // Correctly export as HTTP methods\r\n export { handler as GET, handler as POST };\r\n-export const config = {\r\n-  runtime: \"nodejs\",\r\n-};\r\n+export const runtime = \"nodejs\";\r\n"
                },
                {
                    "date": 1739465965869,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -98,5 +98,4 @@\n const handler = NextAuth(authOptions);\r\n \r\n // Correctly export as HTTP methods\r\n export { handler as GET, handler as POST };\r\n-export const runtime = \"nodejs\";\r\n"
                },
                {
                    "date": 1739467531074,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -3,8 +3,10 @@\n import axios from \"axios\";\r\n import jwt, { JwtPayload } from \"jsonwebtoken\";\r\n import { JWT } from \"next-auth/jwt\";\r\n \r\n+\r\n+\r\n const authOptions: AuthOptions = {\r\n \r\n   providers: [\r\n     CredentialsProvider({\r\n"
                }
            ],
            "date": 1739030240877,
            "name": "Commit-0",
            "content": "import NextAuth, { AuthOptions } from \"next-auth\";\r\nimport CredentialsProvider from \"next-auth/providers/credentials\";\r\nimport axios from \"axios\";\r\nimport jwt, { JwtPayload } from \"jsonwebtoken\";\r\nimport { JWT } from \"next-auth/jwt\";\r\nimport { cookies } from \"next/headers\";\r\nimport { UserInformation } from \"@/types\";\r\n\r\nconst authOptions: AuthOptions = {\r\n\r\n  providers: [\r\n    CredentialsProvider({\r\n      name: \"Credentials\",\r\n      credentials: {\r\n        email: { label: \"Email\", type: \"text\" },\r\n        password: { label: \"Password\", type: \"password\" },\r\n      },\r\n      authorize: async (credentials) => {\r\n        try {\r\n          const response = await axios.post(\r\n            \"http://localhost:8080/api/auth/login\",\r\n            {\r\n              email: credentials?.email,\r\n              password: credentials?.password,\r\n            }\r\n          );\r\n\r\n          const { token } = response.data;\r\n\r\n          if (token) {\r\n            // Decode the JWT token\r\n            const decodedToken = jwt.decode(token) as JwtPayload;\r\n\r\n            // Return the user object\r\n\r\n            return {\r\n              email: credentials?.email,\r\n              id: decodedToken.id,\r\n              role: decodedToken.role,\r\n              name: decodedToken.name,\r\n              profileImg: decodedToken.profileImg,\r\n              verified: decodedToken.verified,\r\n              expires: decodedToken.expires,\r\n              code:decodedToken.code,\r\n              token,\r\n            };\r\n          }\r\n          return null; // Return null if no token is found\r\n        } catch (error: any) {\r\n          console.error(\"Login Error:\", error.response?.data || error.message);\r\n\r\n          if (error.response) {\r\n            const { status, data } = error.response;\r\n            if (status === 401) throw new Error(\"Invalid email or password.\");\r\n            if (status === 403)\r\n              throw new Error(data?.msg || \"Access forbidden.\");\r\n            throw new Error(data?.msg || \"An unexpected error occurred.\");\r\n          }\r\n\r\n          throw new Error(\"Unable to connect to the server.\");\r\n        }\r\n      },\r\n    }),\r\n  ],\r\n  callbacks: {\r\n    async jwt({ token, user }: { token: JWT; user: any }) {\r\n      if (user) {\r\n        token.id = user.id;\r\n        token.role = user.role;\r\n        token.name = user.name;\r\n        token.token = user.token;\r\n        token.profileImg = user.profileImg;\r\n        token.verified = user.verified;\r\n        token.code = user.code\r\n      }\r\n\r\n      return token;\r\n    },\r\n    async session({ session, token }) {\r\n      // const response = await fetch(`http://localhost:8080/api/auth/${token.id}`)\r\n      // const data = await response.json() \r\n      // const user = data.existingUser as UserInformation\r\n      if (token) {\r\n        session.user = {\r\n          ...session.user,\r\n          id: token.id,\r\n          role: token.role,\r\n          image: token.profileImg as string,\r\n          name: token.name,\r\n          verified: token.verified,\r\n          code:token.code\r\n        };\r\n      }\r\n      console.log(session);\r\n      return session;\r\n    },\r\n  },\r\n  secret: process.env.NEXTAUTH_SECRET,\r\n};\r\n\r\nconst handler = NextAuth(authOptions);\r\n\r\n// Correctly export as HTTP methods\r\nexport { handler as GET, handler as POST };\r\n"
        }
    ]
}